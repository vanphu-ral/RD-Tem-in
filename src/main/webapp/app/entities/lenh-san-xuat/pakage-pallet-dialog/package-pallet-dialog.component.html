<div class="dialog-container">
  <!-- Header -->
  <div class="dialog-header">
    <div class="dialog-title">
      <mat-icon class="title-icon">layers</mat-icon>
      <h2>Package Pallet</h2>
    </div>
    <button mat-icon-button (click)="onClose()" class="close-button">
      <mat-icon>close</mat-icon>
    </button>
  </div>

  <!-- Content -->
  <div class="dialog-content">
    <!-- Export button -->
    <div class="action-bar">
      <button mat-raised-button (click)="onExport()" class="export-button">
        <mat-icon>download</mat-icon>
        Xuất file
      </button>
    </div>

    <!-- Table -->
    <div class="table-container">
      <table mat-table [dataSource]="paginatedItems" class="pallet-table">
        <!-- STT Column -->
        <ng-container matColumnDef="stt">
          <th mat-header-cell *matHeaderCellDef>STT</th>
          <td mat-cell *matCellDef="let element">{{ element.stt }}</td>
        </ng-container>

        <!-- Mã pallet with QR Code Column -->
        <ng-container matColumnDef="maPallet">
          <th mat-header-cell *matHeaderCellDef>Mã pallet</th>
          <td mat-cell *matCellDef="let element">
            <div class="qr-code-container">
              <div class="qr-code-placeholder">
                <qrcode
                  [qrdata]="element.maPallet"
                  [width]="80"
                  [errorCorrectionLevel]="'M'"
                >
                </qrcode>
              </div>
            </div>
          </td>
        </ng-container>

        <!-- Mã pallet Text Column -->
        <ng-container matColumnDef="maPalletCode">
          <th mat-header-cell *matHeaderCellDef>Mã pallet</th>
          <td mat-cell *matCellDef="let element" class="pallet-code">
            {{ element.maPallet }}
          </td>
        </ng-container>

        <!-- Tiến độ scan Column -->
        <ng-container matColumnDef="tienDoScan">
          <th mat-header-cell *matHeaderCellDef>Tiến độ scan</th>
          <td mat-cell *matCellDef="let element">
            <div class="progress-container">
              <mat-progress-bar
                mode="determinate"
                [value]="getProgressPercentage(element)"
                [color]="
                  getProgressPercentage(element) === 100 ? 'primary' : 'accent'
                "
              >
              </mat-progress-bar>
              <span class="progress-text"
                >{{ element.tienDoScan }}/{{ element.tongSoThung }}</span
              >
            </div>
          </td>
        </ng-container>

        <!-- Sức chứa Column -->
        <ng-container matColumnDef="sucChua">
          <th mat-header-cell *matHeaderCellDef>Sức chứa</th>
          <td mat-cell *matCellDef="let element">{{ element.sucChua }}</td>
        </ng-container>

        <!-- Tùy chọn Column -->
        <ng-container matColumnDef="tuyChon">
          <th mat-header-cell *matHeaderCellDef>Tùy chọn</th>
          <td mat-cell *matCellDef="let element">
            <button
              mat-icon-button
              (click)="onPrint(element)"
              class="print-button"
            >
              <mat-icon>print</mat-icon>
            </button>
            <button
              mat-icon-button
              (click)="openScanDialog(element)"
              matTooltip="Scan thùng"
              matTooltipPosition="above"
              class="print-button"
            >
              <mat-icon>qr_code_scanner</mat-icon>
            </button>
          </td>
        </ng-container>

        <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
        <tr mat-row *matRowDef="let row; columns: displayedColumns"></tr>
      </table>
    </div>

    <!-- Pagination -->
    <div class="pagination-container">
      <mat-paginator
        [length]="totalItems"
        [pageSize]="pageSize"
        [pageIndex]="pageIndex"
        [pageSizeOptions]="[5, 10, 25, 50]"
        (page)="onPageChange($event)"
        showFirstLastButtons
      >
      </mat-paginator>
    </div>
  </div>
</div>
